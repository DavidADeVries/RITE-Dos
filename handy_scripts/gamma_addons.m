% what % of points inside field have gamma <1 ?

 gamma_eval=GammaEval(eclipse,DOSE_calc,3,3);

gamma=gamma_eval;  % CHANGE AS NEEDED
gamma=gamma.*mask;

%how many pixels pass gamma analysis?
GammaPassPercent=100-(100*length(find((gamma.*mask)>1))/length(find(mask>0)))
mean(mean(PercentDiffMatrix(182:203,246:266)))



figure('Colormap',...
    [0 0 1;0 0.0322580635547638 0.967741906642914;0 0.0645161271095276 0.935483872890472;0 0.0967741906642914 0.903225779533386;0 0.129032254219055 0.870967745780945;0 0.161290317773819 0.838709652423859;0 0.193548381328583 0.806451618671417;0 0.225806444883347 0.774193525314331;0 0.25806450843811 0.74193549156189;0 0.290322571992874 0.709677398204803;0 0.322580635547638 0.677419364452362;0 0.354838699102402 0.645161271095276;0 0.387096762657166 0.612903237342834;0 0.419354826211929 0.580645143985748;0 0.451612889766693 0.548387110233307;0 0.483870953321457 0.516129016876221;0 0.516129016876221 0.483870953321457;0 0.548387110233307 0.451612889766693;0 0.580645143985748 0.419354826211929;0 0.612903237342834 0.387096762657166;0 0.645161271095276 0.354838699102402;0 0.677419364452362 0.322580635547638;0 0.709677398204803 0.290322571992874;0 0.74193549156189 0.25806450843811;0 0.774193525314331 0.225806444883347;0 0.806451618671417 0.193548381328583;0 0.838709652423859 0.161290317773819;0 0.870967745780945 0.129032254219055;0 0.903225779533386 0.0967741906642914;0 0.935483872890472 0.0645161271095276;0 0.967741906642914 0.0322580635547638;0 1 0;1 0 0;1 0.0322580635547638 0;1 0.0645161271095276 0;1 0.0967741906642914 0;1 0.129032254219055 0;1 0.161290317773819 0;1 0.193548381328583 0;1 0.225806444883347 0;1 0.25806450843811 0;1 0.290322571992874 0;1 0.322580635547638 0;1 0.354838699102402 0;1 0.387096762657166 0;1 0.419354826211929 0;1 0.451612889766693 0;1 0.483870953321457 0;1 0.516129016876221 0;1 0.548387110233307 0;1 0.580645143985748 0;1 0.612903237342834 0;1 0.645161271095276 0;1 0.677419364452362 0;1 0.709677398204803 0;1 0.74193549156189 0;1 0.774193525314331 0;1 0.806451618671417 0;1 0.838709652423859 0;1 0.870967745780945 0;1 0.903225779533386 0;1 0.935483872890472 0;1 0.967741906642914 0;1 1 0]);
imagesc(gamma)
colorbar; set(gca, 'CLim', [0 2]);
title('Gamma Map (3%3mm) masked to field size')

mean(mean(eclipse(182:203,246:266)))
mean(mean(DOSE_calc(182:203,246:266)))
mean(mean(PercentDiffMatrix(182:203,246:266)))

mean(mean(wed_total_TRANSP(182:203,246:266)))

% OLD STUFF
% 
% figure; imagesc(DOSE_FcorrDerek_masked_Fw06fs10c); colorbar;
% title 'Calc D'
% 
% figure; imagesc(eclipse_masked); colorbar;
% title 'Eclipse D'
% 
% figure;
% subplot(3,1,1)
% plot(DOSE_FcorrDerek_masked(115,:));
% axis([130 380 0 80])
% title 'row 115 (cross-plane)'
% hold
% plot(eclipse_masked(115,:),'r');
% legend('Calc D','Eclipse D','Location','South')
% 
% subplot(3,1,2)
% plot(DOSE_FcorrDerek_masked(192,:));
% axis([130 380 0 80])
% title 'row 192 (cross-plane)'
% hold
% plot(eclipse_masked(115,:),'r');
% legend('Calc D','Eclipse D','Location','South')
% 
% subplot(3,1,3)
% plot(DOSE_FcorrDerek_masked(:,335));
% axis([80 310 40 80])
% title 'col 335 (in-plane)'
% hold
% plot(eclipse_masked(:,335),'r');
% legend('Calc D','Eclipse D','Location','South')
% 

% factor=zeros(384,512);
% for r=1:384
%     for c=1:512
%         if mask(r,c)==1
%             factor(r,c)=DOSE(r,c)/eclipse(r,c);
%         end
%     end
% end
% 
% mean2(factor(183:202,247:266))
% 
% DOSE_FcorrDerek_masked_w12fs05_divBy1p0679=DOSE_FcorrDerek_masked_w12fs05/1.0679;
% DOSE_FcorrDerek_masked_w12fs10_divBy1p0679=DOSE_FcorrDerek_masked_w12fs10/1.0679;


